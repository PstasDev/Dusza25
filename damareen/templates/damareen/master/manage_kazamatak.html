{% extends 'damareen/base.html' %}

{% block title %}Kazamat√°k kezel√©se{% endblock %}

{% block content %}
<h2>üè∞ Kazamat√°k kezel√©se</h2>

<div style="text-align: right; margin-bottom: 20px;">
    <a href="{% url 'damareen:create_kazamata' %}" class="btn btn-primary">
        ‚ûï √öj kazamata l√©trehoz√°sa
    </a>
    <a href="{% url 'damareen:master_dashboard' %}" class="btn btn-secondary">
        ‚¨ÖÔ∏è Vissza a f≈ëoldalra
    </a>
</div>

{% if kazamatak %}
    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 20px; margin-top: 30px;">
        {% for kazamata in kazamatak %}
        <div class="card" style="border-left-color: 
            {% if kazamata.tipus == 'egyszeru' %}#9b59b6
            {% elif kazamata.tipus == 'kis' %}#3498db
            {% else %}#e74c3c{% endif %};">
            
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                <h3 style="margin: 0; color: 
                    {% if kazamata.tipus == 'egyszeru' %}#9b59b6
                    {% elif kazamata.tipus == 'kis' %}#3498db
                    {% else %}#e74c3c{% endif %};">
                    {{ kazamata.nev }}
                </h3>
                <span style="background: linear-gradient(135deg, 
                    {% if kazamata.tipus == 'egyszeru' %}#9b59b6 0%, #8e44ad 100%
                    {% elif kazamata.tipus == 'kis' %}#3498db 0%, #2980b9 100%
                    {% else %}#e74c3c 0%, #c0392b 100%{% endif %}); 
                    color: white; padding: 4px 10px; border-radius: 12px; font-size: 11px; font-weight: bold;">
                    {{ kazamata.get_tipus_display }}
                </span>
            </div>
            
            <p style="color: #cbd5e0; font-size: 14px; margin-bottom: 15px;">
                {{ kazamata.leiras|truncatewords:15 }}
            </p>
            
            <div style="background: rgba(26, 26, 46, 0.6); padding: 12px; border-radius: 8px; margin-bottom: 15px;">
                <h4 style="color: #daa520; margin-bottom: 10px; font-size: 14px;">üìú K√°rty√°k ({{ kazamata.kartyak.count }}):</h4>
                
                {% if kazamata.kartyak.exists %}
                    <div style="display: flex; flex-direction: column; gap: 8px;">
                        {% for kk in kazamata.kartyak.all %}
                            <div style="background: rgba(218, 165, 32, 0.1); padding: 8px; border-radius: 6px; border-left: 3px solid 
                                {% if kk.kartya.tipus == 'TUZ' %}#ff4757
                                {% elif kk.kartya.tipus == 'FOLD' %}#8b4513
                                {% elif kk.kartya.tipus == 'VIZ' %}#3498db
                                {% else %}#1dd1a1{% endif %}; display: flex; justify-content: space-between; align-items: center;">
                                
                                <div style="flex: 1;">
                                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                                        <span style="background: rgba(218, 165, 32, 0.2); color: #daa520; padding: 2px 8px; border-radius: 10px; font-size: 10px; font-weight: bold;">
                                            #{{ kk.sorrend }}
                                        </span>
                                        <span style="font-weight: bold; color: 
                                            {% if kk.kartya.tipus == 'TUZ' %}#ff4757
                                            {% elif kk.kartya.tipus == 'FOLD' %}#8b4513
                                            {% elif kk.kartya.tipus == 'VIZ' %}#3498db
                                            {% else %}#1dd1a1{% endif %};">
                                            {{ kk.kartya.nev }}
                                        </span>
                                        {% if kk.is_vezer %}
                                            <span style="color: #daa520; font-size: 16px;" title="Vez√©rk√°rtya">üëë</span>
                                        {% endif %}
                                    </div>
                                    <div style="font-size: 11px; color: #94a3b8;">
                                        <span title="Sebz√©s">‚öîÔ∏è {{ kk.kartya.sebzes }}</span>
                                        <span style="margin-left: 10px;" title="√âleter≈ë">‚ù§Ô∏è {{ kk.kartya.eletero }}</span>
                                        <span style="margin-left: 10px;">{{ kk.kartya.get_tipus_display }}</span>
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                {% else %}
                    <p style="color: #64748b; font-style: italic; font-size: 13px; text-align: center; margin: 10px 0;">
                        M√©g nincsenek hozz√°adott k√°rty√°k
                    </p>
                {% endif %}
            </div>
            
            <div style="background: rgba(218, 165, 32, 0.15); padding: 10px; border-radius: 8px; margin-bottom: 15px;">
                <div style="display: flex; justify-content: space-around; font-size: 13px;">
                    <div style="text-align: center;">
                        <div style="color: #64748b; font-size: 11px;">B√≥nusz</div>
                        <div style="color: #daa520; font-weight: bold;">
                            {% if kazamata.tipus == 'egyszeru' %}+1 ‚öîÔ∏è{% elif kazamata.tipus == 'kis' %}+2 ‚ù§Ô∏è{% else %}+3 ‚öîÔ∏è{% endif %}
                        </div>
                    </div>
                    <div style="text-align: center;">
                        <div style="color: #64748b; font-size: 11px;">Kapacit√°s</div>
                        <div style="color: #cbd5e0; font-weight: bold;">
                            {{ kazamata.kartyak.count }} / 
                            {% if kazamata.tipus == 'egyszeru' %}1
                            {% elif kazamata.tipus == 'kis' %}4
                            {% else %}6{% endif %}
                        </div>
                    </div>
                </div>
            </div>
            
            <div style="display: flex; gap: 10px;">
                <a href="{% url 'damareen:edit_kazamata' kazamata.id %}" class="btn btn-primary" style="flex: 1;">
                    ‚úèÔ∏è Szerkeszt√©s
                </a>
                <a href="{% url 'damareen:delete_kazamata' kazamata.id %}" class="btn btn-danger">
                    üóëÔ∏è T√∂rl√©s
                </a>
            </div>
        </div>
        {% endfor %}
    </div>
{% else %}
    <div class="card" style="text-align: center; padding: 60px 20px; background: rgba(26, 26, 46, 0.6);">
        <p style="font-size: 48px; margin-bottom: 20px;">üè∞</p>
        <h3 style="color: #cbd5e0; margin-bottom: 15px;">M√©g nincsenek kazamat√°k</h3>
        <p style="color: #64748b; margin-bottom: 30px;">
            Hozd l√©tre az els≈ë kazamat√°t a j√°t√©khoz!
        </p>
        <a href="{% url 'damareen:create_kazamata' %}" class="btn btn-primary">
            ‚ûï Kazamata l√©trehoz√°sa
        </a>
    </div>
{% endif %}

<div class="card" style="background: rgba(218, 165, 32, 0.1); border-left-color: #daa520; margin-top: 30px;">
    <h3 style="color: #daa520;">‚ÑπÔ∏è Kazamata t√≠pusok</h3>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-top: 15px;">
        <div style="background: rgba(155, 89, 182, 0.15); padding: 15px; border-radius: 8px; border-left: 3px solid #9b59b6;">
            <h4 style="color: #9b59b6; margin-bottom: 8px;">Egyszer≈± kazamata</h4>
            <ul style="color: #cbd5e0; font-size: 14px; line-height: 1.8; padding-left: 20px;">
                <li>1 norm√°l k√°rtya</li>
                <li>+1 sebz√©s b√≥nusz</li>
                <li>Kezd≈ëknek ide√°lis</li>
            </ul>
        </div>
        <div style="background: rgba(52, 152, 219, 0.15); padding: 15px; border-radius: 8px; border-left: 3px solid #3498db;">
            <h4 style="color: #3498db; margin-bottom: 8px;">Kis kazamata</h4>
            <ul style="color: #cbd5e0; font-size: 14px; line-height: 1.8; padding-left: 20px;">
                <li>3 norm√°l + 1 vez√©rk√°rtya</li>
                <li>+2 √©leter≈ë b√≥nusz</li>
                <li>K√∂zepes kih√≠v√°s</li>
            </ul>
        </div>
        <div style="background: rgba(231, 76, 60, 0.15); padding: 15px; border-radius: 8px; border-left: 3px solid #e74c3c;">
            <h4 style="color: #e74c3c; margin-bottom: 8px;">Nagy kazamata</h4>
            <ul style="color: #cbd5e0; font-size: 14px; line-height: 1.8; padding-left: 20px;">
                <li>5 norm√°l + 1 vez√©rk√°rtya</li>
                <li>+3 sebz√©s b√≥nusz</li>
                <li>Halad√≥knak aj√°nlott</li>
            </ul>
        </div>
    </div>
</div>
{% endblock %}
