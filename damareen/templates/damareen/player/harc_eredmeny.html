{% extends 'damareen/base.html' %}

{% block title %}Harc eredm√©nye{% endblock %}

{% block extra_css %}
<style>
    .battle-result {
        text-align: center;
        padding: 30px;
        border-radius: 15px;
        margin: 30px 0;
        font-size: 28px;
        font-weight: bold;
        font-family: 'Cinzel', serif;
        text-transform: uppercase;
        letter-spacing: 3px;
    }
    
    .battle-result.victory {
        background: linear-gradient(135deg, rgba(46, 125, 50, 0.4) 0%, rgba(27, 94, 32, 0.4) 100%);
        border: 3px solid #4caf50;
        color: #90ee90;
        text-shadow: 0 0 20px rgba(76, 175, 80, 0.8);
        box-shadow: 0 0 30px rgba(76, 175, 80, 0.4);
    }
    
    .battle-result.defeat {
        background: linear-gradient(135deg, rgba(211, 47, 47, 0.4) 0%, rgba(183, 28, 28, 0.4) 100%);
        border: 3px solid #f44336;
        color: #ff6b6b;
        text-shadow: 0 0 20px rgba(244, 67, 54, 0.8);
        box-shadow: 0 0 30px rgba(244, 67, 54, 0.4);
    }
    
    .battle-grid {
        display: grid;
        grid-template-columns: 1fr auto 1fr;
        gap: 30px;
        align-items: start;
        margin: 30px 0;
        padding: 20px;
        background: rgba(20, 20, 40, 0.4);
        border-radius: 12px;
        border: 1px solid rgba(218, 165, 32, 0.2);
    }
    
    .battle-card {
        text-align: center;
        padding: 15px;
    }
    
    .battle-card.player {
        border-right: 2px solid rgba(52, 152, 219, 0.3);
    }
    
    .battle-card.enemy {
        border-left: 2px solid rgba(211, 47, 47, 0.3);
    }
    
    .battle-vs {
        text-align: center;
        font-size: 48px;
        color: #daa520;
        text-shadow: 0 0 20px rgba(218, 165, 32, 0.6);
        font-family: 'Cinzel', serif;
    }
    
    .battle-outcome {
        margin-top: 20px;
        padding: 15px;
        border-radius: 8px;
        font-size: 16px;
        text-align: center;
    }
    
    .battle-outcome.win {
        background: rgba(46, 125, 50, 0.3);
        border: 2px solid #4caf50;
        color: #90ee90;
    }
    
    .battle-outcome.lose {
        background: rgba(211, 47, 47, 0.3);
        border: 2px solid #f44336;
        color: #ff6b6b;
    }
    
    .round-number {
        display: inline-block;
        background: linear-gradient(135deg, #8b4513 0%, #654321 100%);
        color: #daa520;
        padding: 8px 20px;
        border-radius: 20px;
        font-family: 'Cinzel', serif;
        font-weight: 600;
        margin-bottom: 20px;
        border: 2px solid rgba(218, 165, 32, 0.5);
        box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    }
    
    /* ============================================
       MOBILE RESPONSIVE STYLES
       ============================================ */
    
    /* Mobile devices (max-width: 768px) */
    @media screen and (max-width: 768px) {
        .battle-result {
            padding: 20px 15px;
            font-size: 22px;
            letter-spacing: 2px;
            margin: 20px 0;
        }
        
        .battle-grid {
            grid-template-columns: 1fr;
            grid-template-rows: auto auto auto;
            gap: 20px;
            padding: 15px;
            margin: 20px 0;
        }
        
        .battle-card.player {
            border-right: none;
            border-bottom: 2px solid rgba(52, 152, 219, 0.3);
            padding-bottom: 15px;
        }
        
        .battle-vs {
            font-size: 36px;
            order: 2;
            padding: 10px 0;
        }
        
        .battle-card.enemy {
            border-left: none;
            border-top: 2px solid rgba(211, 47, 47, 0.3);
            padding-top: 15px;
        }
        
        .battle-outcome {
            font-size: 14px;
            padding: 12px;
        }
        
        .round-number {
            padding: 6px 16px;
            font-size: 14px;
        }
        
        .kartya {
            margin: 10px auto !important;
            max-width: 100% !important;
        }
    }
    
    /* Small mobile devices (max-width: 480px) */
    @media screen and (max-width: 480px) {
        .battle-result {
            padding: 15px 10px;
            font-size: 18px;
            letter-spacing: 1px;
        }
        
        .battle-grid {
            gap: 15px;
            padding: 12px;
        }
        
        .battle-card h4 {
            font-size: 18px;
        }
        
        .battle-vs {
            font-size: 30px;
        }
        
        .battle-outcome {
            font-size: 13px;
            padding: 10px;
        }
        
        .round-number {
            padding: 5px 14px;
            font-size: 13px;
        }
    }
</style>
{% endblock %}

{% block content %}
<h2>‚öîÔ∏è Harc eredm√©nye</h2>

<div class="card">
    <h3>{{ harc.kazamata.nev }}</h3>
    <p><strong>{{ harc.kazamata.get_tipus_display }}</strong></p>
    <p>Id≈ëpont: {{ harc.inditas|date:"Y.m.d H:i" }}</p>
</div>

<div class="battle-result {% if harc.jatekos_gyozott %}victory{% else %}defeat{% endif %}">
    {% if harc.jatekos_gyozott %}
        üéâ GY≈êZELEM! üéâ
    {% else %}
        üòû VERES√âG üòû
    {% endif %}
</div>

{% if harc.jatekos_gyozott %}
<div class="card" style="text-align: center; border-left-color: #4caf50;">
    <h3 style="color: #90ee90;">üèÜ Jutalom</h3>
    <p style="font-size: 20px; color: #daa520;">{{ harc.kazamata.get_nyeremeny_leiras }}</p>
</div>
{% else %}
<div class="card" style="text-align: center; border-left-color: #f44336;">
    <p style="font-size: 18px; color: #ff6b6b;">
        Pr√≥b√°ld √∫jra vagy √°ll√≠ts √∂ssze √∫j paklit!
    </p>
</div>
{% endif %}

<div class="card" style="margin-top: 30px;">
    <h3>üìä √útk√∂zetek r√©szletei</h3>
    
    {% for utk√∂zet in utk√∂zetek %}
    <div style="margin: 30px 0;">
        <div style="text-align: center;">
            <span class="round-number">‚öîÔ∏è √útk√∂zet #{{ utk√∂zet.sorrend }}</span>
        </div>
        
        <div class="battle-grid">
            <!-- J√°t√©kos k√°rtya -->
            <div class="battle-card player">
                <h4 style="color: #64b5f6; font-size: 22px;">üë§ Saj√°t k√°rtya</h4>
                <div class="kartya kartya-{{ utk√∂zet.jatekos_tipus }}" style="margin: 15px auto; max-width: 250px;">
                    <h3>{{ utk√∂zet.jatekos_kartya.eredeti_kartya.nev }}</h3>
                    <div class="kartya-stat">
                        <span>‚öîÔ∏è Sebz√©s:</span>
                        <span style="color: #daa520;">{{ utk√∂zet.jatekos_sebzes }}</span>
                    </div>
                    <div class="kartya-stat">
                        <span>‚ù§Ô∏è √âleter≈ë:</span>
                        <span style="color: #e74c3c;">{{ utk√∂zet.jatekos_eletero }}</span>
                    </div>
                    <div style="margin-top: 10px; text-align: center;">
                        <span class="elem-icon elem-{{ utk√∂zet.jatekos_tipus }}">
                            {{ utk√∂zet.get_jatekos_tipus_display }}
                        </span>
                    </div>
                </div>
            </div>
            
            <!-- VS -->
            <div class="battle-vs">
                ‚öîÔ∏è
            </div>
            
            <!-- Kazamata k√°rtya -->
            <div class="battle-card enemy">
                <h4 style="color: #ff6b6b; font-size: 22px;">üè∞ Ellens√©g</h4>
                <div class="kartya kartya-{{ utk√∂zet.kazamata_tipus }}" style="margin: 15px auto; max-width: 250px;">
                    <h3>
                        {% if utk√∂zet.kazamata_kartya_ref.vilag_kartya %}
                            {{ utk√∂zet.kazamata_kartya_ref.vilag_kartya.nev }}
                        {% else %}
                            {{ utk√∂zet.kazamata_kartya_ref.vezer_kartya.nev }} üëë
                        {% endif %}
                    </h3>
                    <div class="kartya-stat">
                        <span>‚öîÔ∏è Sebz√©s:</span>
                        <span style="color: #daa520;">{{ utk√∂zet.kazamata_sebzes }}</span>
                    </div>
                    <div class="kartya-stat">
                        <span>‚ù§Ô∏è √âleter≈ë:</span>
                        <span style="color: #e74c3c;">{{ utk√∂zet.kazamata_eletero }}</span>
                    </div>
                    <div style="margin-top: 10px; text-align: center;">
                        <span class="elem-icon elem-{{ utk√∂zet.kazamata_tipus }}">
                            {{ utk√∂zet.get_kazamata_tipus_display }}
                        </span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="battle-outcome {% if utk√∂zet.jatekos_nyert %}win{% else %}lose{% endif %}">
            <strong>
                {% if utk√∂zet.jatekos_nyert %}
                    ‚úÖ J√°t√©kos gy≈ëz√∂tt
                {% else %}
                    ‚ùå Kazamata gy≈ëz√∂tt
                {% endif %}
            </strong>
            <br>
            <span style="font-size: 14px; opacity: 0.9;">{{ utk√∂zet.gyoztes_ok }}</span>
        </div>
    </div>
    {% endfor %}
</div>

<div style="margin-top: 40px; text-align: center;">
    {% if harc.jatekos_gyozott %}
        <a href="{% url 'damareen:jutalom_valaszt' jatek.id harc.id %}" class="btn btn-success" style="font-size: 18px;">
            üéÅ Jutalom √°tv√©tele
        </a>
    {% else %}
        <a href="{% url 'damareen:game_view' jatek.id %}" class="btn" style="font-size: 18px;">
            üîô Vissza a j√°t√©khoz
        </a>
    {% endif %}
</div>
{% endblock %}
